/* Browser-safe replacement for @mariozechner/pi-web-ui/app.css */
@import "@mariozechner/mini-lit/styles/themes/default.css";

/* Let Tailwind v4 scan third-party component class usage. */
/* biome-ignore lint/suspicious/noUnknownAtRules: Tailwind 4 source directive */
@source "../../node_modules/@mariozechner/mini-lit/dist";
/* biome-ignore lint/suspicious/noUnknownAtRules: Tailwind 4 source directive */
@source "../../node_modules/@mariozechner/pi-web-ui/dist";

/* biome-ignore lint/correctness/noInvalidPositionAtImportRule: Tailwind import */
@import "tailwindcss";

body {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
}

* {
  scrollbar-width: thin;
  scrollbar-color: var(--color-border) rgba(0, 0, 0, 0);
}

*::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

*::-webkit-scrollbar-track {
  background: transparent;
}

*::-webkit-scrollbar-thumb {
  background-color: var(--color-border);
  border-radius: 4px;
}

*::-webkit-scrollbar-thumb:hover {
  background-color: rgba(0, 0, 0, 0);
}

.fixed.inset-0 button[aria-label*="Close"],
.fixed.inset-0 button[type="button"] {
  cursor: pointer;
}

@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.animate-shimmer {
  animation: shimmer 2s ease-in-out infinite;
}

:root {
  --chat-user-bg: linear-gradient(135deg, #95ec69 0%, #7fdd55 100%);
  --chat-user-border: #67bf43;
  --chat-user-text: #10290b;
  --chat-ai-bg: color-mix(in oklab, var(--background) 93%, var(--foreground) 7%);
  --chat-ai-border: color-mix(in oklab, var(--foreground) 22%, var(--border));
  --chat-loader-dot: color-mix(in oklab, var(--foreground) 74%, transparent);
}

.dark {
  --chat-user-bg: linear-gradient(135deg, #4f9f2f 0%, #6bbf3f 100%);
  --chat-user-border: #86d967;
  --chat-user-text: #ecffe3;
  --chat-ai-bg: color-mix(in oklab, var(--background) 86%, white 14%);
  --chat-ai-border: color-mix(in oklab, white 28%, var(--border));
  --chat-loader-dot: color-mix(in oklab, white 82%, transparent);
}

message-list user-message > div {
  justify-content: flex-end !important;
  margin-left: 0 !important;
  margin-right: 0 !important;
  padding-left: 0.5rem;
  padding-right: 0.5rem;
}

.user-message-container {
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  background: var(--chat-user-bg);
  color: var(--chat-user-text);
  border: 1px solid var(--chat-user-border);
  border-radius: 16px 16px 6px 16px;
  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.16);
  backdrop-filter: none;
  max-width: min(78%, 44rem);
}

message-list assistant-message > div,
streaming-message-container assistant-message > div {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}

message-list assistant-message > div > .px-4.flex.flex-col.gap-3,
streaming-message-container assistant-message > div > .px-4.flex.flex-col.gap-3 {
  max-width: min(78%, 44rem);
  margin-left: 0.5rem;
  margin-right: auto;
  padding: 0.8rem 1rem !important;
  border-radius: 16px 16px 16px 6px;
  border: 1px solid var(--chat-ai-border);
  background: var(--chat-ai-bg);
  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.1);
}

message-list assistant-message > div > .text-xs.text-muted-foreground,
streaming-message-container assistant-message > div > .text-xs.text-muted-foreground {
  margin-left: 0.75rem;
  padding-left: 0;
}

@keyframes limerence-chat-dot-pulse {
  0%,
  80%,
  100% {
    opacity: 0.24;
    transform: translateY(0) scale(0.82);
  }
  40% {
    opacity: 1;
    transform: translateY(-1px) scale(1);
  }
}

streaming-message-container > div > span.w-2.h-4.bg-muted-foreground.animate-pulse {
  position: relative;
  width: 7px !important;
  height: 7px !important;
  border-radius: 999px;
  background: var(--chat-loader-dot) !important;
  margin-left: 1.15rem !important;
  margin-right: 0 !important;
  animation: limerence-chat-dot-pulse 1.05s ease-in-out infinite !important;
}

streaming-message-container > div > span.w-2.h-4.bg-muted-foreground.animate-pulse::before,
streaming-message-container > div > span.w-2.h-4.bg-muted-foreground.animate-pulse::after {
  content: "";
  position: absolute;
  top: 0;
  width: 7px;
  height: 7px;
  border-radius: 999px;
  background: var(--chat-loader-dot);
  animation: limerence-chat-dot-pulse 1.05s ease-in-out infinite;
}

streaming-message-container > div > span.w-2.h-4.bg-muted-foreground.animate-pulse::before {
  left: -12px;
  animation-delay: -0.2s;
}

streaming-message-container > div > span.w-2.h-4.bg-muted-foreground.animate-pulse::after {
  left: 12px;
  animation-delay: 0.2s;
}

@media (max-width: 768px) {
  .user-message-container,
  message-list assistant-message > div > .px-4.flex.flex-col.gap-3,
  streaming-message-container assistant-message > div > .px-4.flex.flex-col.gap-3 {
    max-width: min(88%, 36rem);
  }
}

@media (prefers-reduced-motion: reduce) {
  streaming-message-container > div > span.w-2.h-4.bg-muted-foreground.animate-pulse,
  streaming-message-container > div > span.w-2.h-4.bg-muted-foreground.animate-pulse::before,
  streaming-message-container > div > span.w-2.h-4.bg-muted-foreground.animate-pulse::after {
    animation: none !important;
    opacity: 0.72;
    transform: none;
  }
}

/* ── Particle Lenia loader bubble ─────────────────────────────── */

#lenia-loading-bubble {
  max-width: 48rem;
  margin-left: auto;
  margin-right: auto;
  padding: 0 1rem 0.5rem;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  animation: lenia-bubble-enter 0.25s ease-out;
}

#lenia-loading-bubble .lenia-loader-canvas {
  display: block;
  margin-left: 0.5rem;
  padding: 0.6rem 0.8rem;
  border-radius: 16px 16px 16px 6px;
  border: 1px solid var(--chat-ai-border);
  background: var(--chat-ai-bg);
  box-shadow: 0 8px 22px rgba(0, 0, 0, 0.1);
  pointer-events: none;
}

#lenia-loading-bubble.lenia-bubble-exit {
  animation: lenia-bubble-exit 0.2s ease-in forwards;
}

@keyframes lenia-bubble-enter {
  from { opacity: 0; transform: translateY(6px) scale(0.95); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

@keyframes lenia-bubble-exit {
  from { opacity: 1; transform: scale(1); }
  to { opacity: 0; transform: scale(0.92); }
}

@media (prefers-reduced-motion: reduce) {
  #lenia-loading-bubble,
  #lenia-loading-bubble.lenia-bubble-exit {
    animation: none;
  }
}

/* ── Typing indicator (WeChat-style) ──────────────────────────── */

.limerence-typing-indicator {
  display: inline-flex;
  align-items: center;
  gap: 2px;
  font-size: 0.7rem;
  color: var(--chat-loader-dot);
  opacity: 0.85;
  white-space: nowrap;
  animation: limerence-typing-fade-in 0.3s ease-out;
}

.limerence-typing-dots {
  display: inline-flex;
  gap: 1.5px;
  margin-left: 1px;
}

.limerence-typing-dots::before,
.limerence-typing-dots::after,
.limerence-typing-dots {
  line-height: 1;
}

.limerence-typing-dots::before {
  content: "···";
  letter-spacing: 0.5px;
  animation: limerence-typing-ellipsis 1.4s steps(4, end) infinite;
  overflow: hidden;
  display: inline-block;
  width: 0;
}

@keyframes limerence-typing-ellipsis {
  0% { width: 0; }
  25% { width: 0.4em; }
  50% { width: 0.8em; }
  75% { width: 1.2em; }
  100% { width: 0; }
}

@keyframes limerence-typing-fade-in {
  from { opacity: 0; transform: translateY(-2px); }
  to { opacity: 0.85; transform: translateY(0); }
}
